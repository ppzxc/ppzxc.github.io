---
type: post
date: 2017-05-08 18:50:59
title: GCP에 CI 구축하기
draft: false
author: ppzxc
tags:
  - CI
---

### Google Cloud Platform에 CI 구축하기

GCP 프로모션을 통해 1년간 사용할 수 있는 무료 크레딧 $300을 지원받았다.
이를 통해 CentOS를 설치하고 Jenkins, SonarQube를 운용중이다.
여기에 Slack을 연동하고 github과 gitlab repo를 연동시켜 각 프로젝트의 일일 빌드를
수행하는데 이용하고 있다.

늘 그렇듯 구글 검색과 삽질의 연속으로 각각 연동 시켰는데, 큰 어려움은 없었지만
네트워크 inbound, outbound 설정에서 많이 애를 먹었다. 공식 url인 gitlab, github의
ip가 아니라 연결된 repo에서 webhook이나 checkout을 수행할때 들어오고 나오는 ip가
달랐는데, 이 또한 구글신의 도움으로 해결했다.

GCP Inbound  
Gitlab In  
52.184.189.123  
52.184.194.155  
52.184.195.9  
52.184.195.32  
52.184.195.57  
52.184.196.138  
52.184.198.203  
58.221.55.205  
52.167.214.135

Gitlab out  
52.184.189.123  
52.184.194.155  
52.184.195.9  
52.184.195.32  
52.184.195.57  
52.184.196.138  
52.184.198.203  
58.221.55.205  
52.167.214.135

slack Inbound  
54.230.251.234  
54.169.142.40  
54.230.248.67  
52.84.188.161  
34.197.17.145  
107.23.98.243  
52.71.151.85  
52.3.21.159

Slack outbound  
54.230.251.234  
54.169.142.40  
54.230.248.67  
52.84.188.161  
34.197.17.145  
107.23.98.243  
52.71.151.85  
52.3.21.159

무식한 방법이지만 이중 ip가 각각 hook과 repo checkout을 수행하는데 사용하는 IP
였거니 라는 엔지니어 답지않은 마인드로 방화벽 규칙을 등록했다.

더 좋은 방법이 있다면 조언 부탁드립니다!!

이상! 삽질기 끝
